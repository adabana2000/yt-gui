# YouTube ダウンローダー 仕様書 v1.0

## 1. プロジェクト概要

### 1.1 目的
yt-dlpをベースとした高機能YouTubeダウンローダーの開発。ユーザーフレンドリーなGUIと豊富な自動化機能により、YouTubeコンテンツの効率的な管理・保存を実現する。

### 1.2 対象ユーザー
- コンテンツアーカイブを必要とする個人ユーザー
- 教育・研究目的でのコンテンツ保存を行うユーザー
- コンテンツクリエイター

### 1.3 動作環境
- **OS**: Windows 10/11, macOS 10.15+, Ubuntu 20.04+
- **必要スペック**:
  - RAM: 4GB以上（推奨8GB）
  - ストレージ: 10GB以上の空き容量
  - GPU: NVENC/QuickSync/AMF対応GPU（オプション）
  - インターネット接続: ブロードバンド接続推奨

## 2. 機能仕様

### 2.1 ダウンロード機能

#### 2.1.1 基本ダウンロード機能
- **単一動画ダウンロード**
  - URL入力による直接ダウンロード
  - 動画情報のプレビュー表示
  - ダウンロード前の品質選択

- **マルチスレッドダウンロード**
  - 同時ダウンロード数: 1-10（設定可能）
  - フラグメント並列ダウンロード対応
  - 動的スレッド数調整機能

- **バッチダウンロード**
  - URLリストファイル（txt/csv）からの一括読み込み
  - エクセルファイルインポート対応
  - ダウンロードキューの視覚的管理

#### 2.1.2 プレイリスト・チャンネル機能
- **プレイリストダウンロード**
  - プレイリスト全体ダウンロード
  - 範囲指定ダウンロード（例: 1-10, 15, 20-25）
  - プレイリスト内検索・フィルタリング
  
- **チャンネル一括ダウンロード**
  - チャンネル内全動画ダウンロード
  - 期間指定ダウンロード
  - 再生回数・評価によるフィルタリング

- **登録チャンネル管理**
  - Googleアカウント連携による登録チャンネル取得
  - チャンネルリストのインポート/エクスポート
  - チャンネルグループ化機能

#### 2.1.3 特殊コンテンツ対応
- **ライブストリーム録画**
  - リアルタイム録画
  - 録画予約機能
  - チャット保存オプション

- **プレミア公開対応**
  - 公開時刻での自動録画開始
  - 待機画面スキップ

- **年齢制限・メンバー限定コンテンツ**
  - Googleアカウント認証によるアクセス
  - Cookie管理機能

### 2.2 自動化・スケジューリング機能

#### 2.2.1 定期ダウンロード
- **スケジュール設定**
  - Cron式スケジュール指定
  - GUIベースの簡易スケジュール設定
  - 曜日・時間帯指定

- **新着動画チェック**
  - チャンネル単位での更新確認
  - RSS/Atomフィード監視
  - 通知機能（デスクトップ/メール/Discord）

#### 2.2.2 自動リトライ・エラー処理
- **リトライ機能**
  - 最大リトライ回数設定（1-10回）
  - リトライ間隔設定（指数バックオフ対応）
  - 部分ダウンロード済みファイルの再開

- **エラーハンドリング**
  - エラー種別による処理分岐
  - ネットワークエラー時の待機機能
  - 失敗ログの詳細記録

#### 2.2.3 ダウンロード優先度管理
- **キュー管理**
  - 優先度レベル設定（高/中/低）
  - ドラッグ&ドロップによる順序変更
  - 条件付き優先度設定（チャンネル別等）

### 2.3 認証・アクセス管理

#### 2.3.1 アカウント管理
- **Googleアカウント連携**
  - OAuth 2.0認証
  - 複数アカウント登録・切り替え
  - セッション管理

- **Cookie管理**
  - ブラウザからのCookie自動インポート
  - Cookieファイルの手動インポート/エクスポート
  - Cookie有効期限管理

#### 2.3.2 プロキシ・VPN対応
- **プロキシ設定**
  - HTTP/HTTPS/SOCKS5プロキシ対応
  - プロキシリスト管理
  - 自動プロキシ切り替え

- **地域制限回避**
  - 国別プロキシ設定
  - VPN統合（オプション）

### 2.4 メタデータ・ファイル管理

#### 2.4.1 メタデータ取得・保存
- **基本メタデータ**
  - タイトル、説明文、タグ
  - 投稿日時、再生回数、評価数
  - JSON/XMLフォーマット保存

- **追加コンテンツ**
  - サムネイル画像（複数解像度）
  - 字幕ファイル（全言語/選択言語）
  - チャプター情報
  - コメント（返信含む）

#### 2.4.2 ファイル命名・整理
- **命名規則カスタマイズ**
  - テンプレート変数使用
    - {title}, {channel}, {date}, {id}等
  - 文字数制限設定
  - 禁止文字自動置換

- **フォルダ構造管理**
  - 自動フォルダ作成ルール
    - チャンネル別
    - 年月別
    - プレイリスト別
  - カスタムフォルダ構造定義

#### 2.4.3 ダウンロード履歴
- **履歴管理**
  - ダウンロード済みURL記録
  - 重複チェック機能
  - 履歴検索・フィルタリング

- **データベース管理**
  - SQLiteデータベース使用
  - 全文検索対応
  - バックアップ・リストア機能

### 2.5 エンコード・変換機能

#### 2.5.1 フォーマット設定
- **動画フォーマット**
  - コンテナ: MP4, MKV, WebM, AVI, MOV
  - コーデック: H.264, H.265, VP9, AV1
  - 解像度: 144p～8K、カスタム解像度

- **音声フォーマット**
  - 形式: MP3, AAC, FLAC, OGG, OPUS
  - ビットレート: 32kbps～320kbps
  - サンプリングレート設定

#### 2.5.2 GPUアクセラレーション
- **対応GPU**
  - NVIDIA: NVENC (GTX 10xx以降)
  - Intel: QuickSync
  - AMD: AMF/VCE

- **エンコード設定**
  - プリセット選択（品質/速度バランス）
  - ビットレート制御（CBR/VBR）
  - 2パスエンコード対応

#### 2.5.3 後処理機能
- **動画編集**
  - トリミング（開始/終了時刻指定）
  - チャプター分割
  - 複数動画結合

- **音声処理**
  - 音声のみ抽出
  - ノーマライゼーション
  - 無音部分の自動カット

- **追加処理**
  - 透かし追加/除去
  - SponsorBlock統合
  - 広告セグメントスキップ

### 2.6 ユーザーインターフェース

#### 2.6.1 デスクトップGUI
- **メインウィンドウ**
  - モダンなデザイン（Material Design準拠）
  - ダークモード/ライトモード切り替え
  - レスポンシブレイアウト

- **機能別タブ**
  - ダウンロード管理
  - スケジュール設定
  - 履歴閲覧
  - 設定

#### 2.6.2 システム統合
- **システムトレイ**
  - バックグラウンド動作
  - 進捗表示
  - クイックアクション

- **クリップボード監視**
  - YouTube URL自動検出
  - ダウンロード確認ポップアップ
  - ホットキー設定

- **ドラッグ&ドロップ**
  - URL/ファイルのドロップ対応
  - 複数アイテム同時処理

#### 2.6.3 通知システム
- **デスクトップ通知**
  - ダウンロード完了通知
  - エラー通知
  - 新着動画通知

- **外部通知**
  - メール通知
  - Discord/Slack Webhook
  - プッシュ通知（モバイル連携）

### 2.7 モニタリング・統計

#### 2.7.1 ダウンロード統計
- **リアルタイム監視**
  - ダウンロード速度グラフ
  - 進捗バー（個別/全体）
  - 推定残り時間

- **統計情報**
  - 日/週/月別ダウンロード数
  - チャンネル別統計
  - ストレージ使用状況

#### 2.7.2 ログ機能
- **ログレベル**
  - ERROR, WARNING, INFO, DEBUG
  - カテゴリ別ログ設定
  - ローテーション設定

- **ログ出力**
  - ファイル出力
  - コンソール出力
  - リモートログ送信

### 2.8 設定・カスタマイズ

#### 2.8.1 基本設定
- **ダウンロード設定**
  - デフォルト保存先
  - 同時ダウンロード数
  - 帯域制限

- **動作設定**
  - 起動時の動作
  - 完了時の動作
  - 自動アップデート

#### 2.8.2 詳細設定
- **ネットワーク設定**
  - タイムアウト値
  - リトライ設定
  - User-Agent設定

- **帯域制限**
  - 時間帯別制限
  - 全体/個別制限
  - 優先度別制限

#### 2.8.3 プロファイル管理
- **設定プロファイル**
  - チャンネル別プロファイル
  - 用途別プロファイル
  - プロファイルのインポート/エクスポート

### 2.9 拡張機能

#### 2.9.1 API提供
- **REST API**
  - ダウンロード制御
  - ステータス取得
  - 設定変更

- **WebSocket**
  - リアルタイム進捗
  - イベント通知

#### 2.9.2 プラグインシステム
- **プラグイン種類**
  - ダウンローダープラグイン
  - 後処理プラグイン
  - UI拡張プラグイン

- **プラグイン管理**
  - プラグインストア
  - 自動更新
  - 依存関係管理

### 2.10 セキュリティ

#### 2.10.1 データ保護
- **認証情報管理**
  - 暗号化保存
  - キーチェーン/認証情報マネージャー連携
  - マスターパスワード設定

#### 2.10.2 プライバシー
- **プライバシーモード**
  - 履歴の無効化
  - 一時ファイルの自動削除
  - 匿名化設定

## 3. 今後の拡張計画

### 3.1 Phase 2
- モバイルアプリ連携
- クラウドストレージ統合
- AI based コンテンツ推薦

### 3.2 Phase 3（1年後）
- 他プラットフォーム対応
- コンテンツ編集機能強化
- コラボレーション機能

## 4. 用語集

- **yt-dlp**: youtube-dlのフォーク版ダウンローダー
- **フラグメント**: 動画を分割した断片
- **NVENC**: NVIDIA GPU エンコーダー
- **SponsorBlock**: 広告セグメントスキップサービス

## 5. 改訂履歴

| バージョン | 日付 | 変更内容 | 作成者 |
|-----------|------|---------|--------|
| 1.0 | 2024-11-19 | 初版作成 | - |

---
*本仕様書は定期的に見直し、必要に応じて更新されます。*